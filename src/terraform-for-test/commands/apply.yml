description: |
  Applies the Terraform configuration with "name" set from environment variable NAME.
parameters:
  name-env-var:
    type: env_var_name
    default: NAME
steps:
  - run:
      name: Terraform apply
      command: |
        if [ -z "<< parameters.name-env-var >>" ]; then
          echo "A name (prefix) for the Terraform configuration is required, but the << parameters.name-env-var >> env var is empty."
          exit 2
        fi
        terraform apply \
          -auto-approve -input=false -parallelism=4 \
          -var="name=${<< parameters.name-env-var >>}"
